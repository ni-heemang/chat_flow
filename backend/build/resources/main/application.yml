server:
  port: 8080

spring:
  application:
    name: flowchat
    
  datasource:
    url: ${SPRING_DATASOURCE_URL:jdbc:mysql://localhost:3306/flowchat?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true}
    username: ${SPRING_DATASOURCE_USERNAME:root}
    password: ${SPRING_DATASOURCE_PASSWORD:}
    driver-class-name: com.mysql.cj.jdbc.Driver
    
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.MySQL8Dialect
        format_sql: false
        
  security:
    user:
      name: admin
      password: admin
      
# JWT 설정
jwt:
  secret: flowchatSecretKeyForJwtTokenGenerationAndValidation2024
  expiration: 86400000 # 24시간 (밀리초)

# CORS 설정 (환경변수로 설정 가능)
cors:
  allowed-origins: ${CORS_ALLOWED_ORIGINS:http://localhost:3000,http://localhost:5173,http://localhost:8080,http://localhost:5174}
  allowed-methods: GET,POST,PUT,DELETE,OPTIONS
  allowed-headers: "*"
  allow-credentials: true

# 로깅 설정
logging:
  level:
    com.flowchat: INFO
    org.springframework.web: WARN
    org.springframework.security: WARN
    org.hibernate.SQL: WARN
    org.hibernate.type.descriptor.sql.BasicBinder: WARN
    
# WebSocket 설정
websocket:
  allowed-origins: ${WEBSOCKET_ALLOWED_ORIGINS:http://localhost:3000,http://localhost:5173,http://localhost:8080}

# LLM 분석 설정
llm:
  provider: "openai"  # openai, claude, gemini, ollama 등
  api:
    key: "${LLM_API_KEY:dummy-key-for-development}"
    url: "${LLM_API_URL:https://api.openai.com/v1/chat/completions}"
  model: "${LLM_MODEL:gpt-3.5-turbo}"
  max-tokens: 1000
  temperature: 0.3
  
  # 폴백 설정
  fallback:
    enabled: true
    timeout-seconds: 10
    max-retries: 2
  
  # 배치 처리 설정
  batch:
    enabled: false
    size: 5
    delay-seconds: 2
    
  # 캐시 설정
  cache:
    enabled: true
    ttl-minutes: 30
    max-size: 1000

# 비동기 처리 설정
async:
  core-pool-size: 5
  max-pool-size: 20
  queue-capacity: 100
  thread-name-prefix: "llm-analysis-"

---
# 개발 환경 설정
spring:
  config:
    activate:
      on-profile: dev
  jpa:
    show-sql: true
    properties:
      hibernate:
        format_sql: true

# 로깅 설정
logging:
  level:
    com.flowchat: DEBUG
    org.springframework.web: DEBUG
    org.springframework.security: DEBUG
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE

llm:
  model: "gpt-3.5-turbo"
  max-tokens: 500
  fallback:
    timeout-seconds: 5

---
# 운영 환경 설정  
spring:
  config:
    activate:
      on-profile: prod
  jpa:
    show-sql: false
    properties:
      hibernate:
        format_sql: false

# 로깅 설정
logging:
  level:
    com.flowchat: WARN
    org.springframework.web: ERROR
    org.springframework.security: ERROR
    org.hibernate.SQL: ERROR
    org.hibernate.type.descriptor.sql.BasicBinder: ERROR
    org.springframework.boot.actuate: INFO

# CORS 설정 - EC2 환경에 맞게 설정
cors:
  allowed-origins: ${CORS_ALLOWED_ORIGINS:*}
  
# WebSocket 설정
websocket:
  allowed-origins: ${WEBSOCKET_ALLOWED_ORIGINS:*}

llm:
  model: "gpt-4"
  max-tokens: 1500
  fallback:
    timeout-seconds: 15
  batch:
    enabled: true
    size: 10

---
# 테스트 환경 설정
spring:
  config:
    activate:
      on-profile: test
  
llm:
  provider: "mock"
  api:
    key: "test-key"
  fallback:
    enabled: false